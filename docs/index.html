<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CLT HUB</title>
  <style>
    :root {
      --main-panel-width: 880px;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #218838;
      min-height: 100vh;
      color: #333;
      width: 100vw;
      box-sizing: border-box;
    }
    h1 {
      margin-top: 12px;
      margin-bottom: 12px;
      font-size: 2rem;
      color: #fff;
      text-align: center;
      letter-spacing: 0.04em;
      padding-left: 3mm;
      padding-right: 3mm;
    }
    #lang-select-container {
      position: absolute;
      top: 1rem;
      right: 1rem;
      z-index: 1000;
    }
    #lang-select {
      font-size: 1rem;
      padding: 0.15em 0.6em;
      border-radius: 6px;
      border: 1px solid #999;
      background: #fff;
      color: #14281d;
    }
    #main-area {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100vw;
    }
    .panel-wrap {
      width: var(--main-panel-width);
      max-width: 98vw;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      box-sizing: border-box;
    }
    #welcome, .regulamin-panel {
      width: 100%;
      max-width: 100%;
      box-sizing: border-box;
      border-radius: 10px;
      background: #14281d;
      color: #fff;
      box-shadow: 0 4px 10px rgba(0,0,0,0.11);
      margin-bottom: 18px;
      text-align: justify;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0.54cm 2.3rem 0.6cm 2.3rem;
    }
    .regulamin-panel {
      margin-top: 0;
      padding: 1.1em 2.3rem 1.2em 2.3rem;
      font-size: 1.02em;
    }
    .regulamin-panel h2 {
      font-size: 1.16em;
      color: #fff;
      margin-top: 0;
      margin-bottom: 12px;
      font-weight: 700;
      letter-spacing: 0.02em;
      text-align: left;
      width: 100%;
    }
    .regulamin-panel ul, .regulamin-panel ol {
      padding-left: 22px;
      margin-bottom: 10px;
    }
    .promo-container {
      position: absolute;
      top: 4mm;
      left: 4mm;
    }
    .promo-image {
      width: auto;
      height: 38px;
      border-radius: 5px;
    }
    #welcome p.title {
      text-align: center;
      font-size: 1.18rem;
      margin: 0 0 0.55rem 0;
      font-weight: 600;
      width: 100%;
    }
    #welcome .headline {
      display: block;
      font-size: 1.04em;
      font-weight: 600;
      margin-bottom: 0.15em;
      letter-spacing: 0.03em;
      width: 100%;
      text-align: center;
    }
    #welcome .subtitle {
      display: block;
      font-size: 0.72em;
      font-weight: 400;
      margin-top: 0.18em;
      color: #e0e0e0;
      letter-spacing: 0.01em;
      width: 100%;
      text-align: center;
    }
    .desc-container {
      width: 100%;
      box-sizing: border-box;
      margin: 0.2em 0 0.1em 0;
      padding: 0;
    }
    .desc {
      text-align: justify;
      font-size: 0.97em;
      margin: 0;
      color: #e0e0e0;
      width: 100%;
    }
    .button-row {
      width: 100%;
      display: flex;
      justify-content: center;
      margin: 1.0em 0 1.1em 0;
    }
    #buyAcceptBtn {
      background: #218838;
      color: #fff;
      border: none;
      border-radius: 7px;
      box-shadow: 0 2px 5px rgba(30,60,20,0.10);
      min-width: 240px;
      max-width: 330px;
      width: 100%;
      text-align: center;
      font-size: 1.05em;
      padding: 6px 0 7px 0;
      margin: 0.3em auto 1em auto;
      display: block;
      letter-spacing: 0.01em;
      line-height: 1.07;
      transition: background 0.15s, box-shadow 0.18s;
      cursor: pointer;
    }
    #buyAcceptBtn .btn-main {
      display: block;
      font-weight: 700;
      font-size: 1em;
      margin-bottom: 1.5px;
      line-height: 1.13;
      letter-spacing: 0.01em;
    }
    #buyAcceptBtn .btn-sub {
      display: block;
      font-weight: 400;
      font-size: 0.87em;
      margin-bottom: 1.5px;
      line-height: 1.12;
      letter-spacing: 0.01em;
    }
    #buyAcceptBtn .btn-note {
      display: block;
      font-weight: 400;
      font-size: 0.77em;
      color: #e0e0e0;
      margin-bottom: 0;
      margin-top: 0.5px;
      line-height: 1.08;
      letter-spacing: 0.01em;
    }
    /* Spis treści (dynamika z podsekcjami) */
    #toc-container {
      background: #e0e0e0;
      color: #14281d;
      border-radius: 13px;
      padding: 1.2em 1.6em 1.2em 1.6em;
      margin: 2.6rem auto 1rem auto;
      min-width: 320px;
      width: var(--main-panel-width);
      max-width: 98vw;
      align-self: center;
      box-shadow: 0 2px 12px rgba(20,40,29,0.07);
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: flex-start;
    }
    #toc-container h2 {
      font-size: 1.14rem;
      margin: 0 0 0.45em 0;
      font-weight: 700;
      color: #218838;
      letter-spacing: 0.03em;
      padding: 0;
    }
    .toc-section {
      margin-bottom: 1em;
    }
    .toc-section-title {
      font-size: 1.04em;
      color: #218838;
      font-weight: 600;
      margin-top: 0.25em;
      margin-bottom: 0.22em;
      letter-spacing: 0.01em;
    }
    .toc-list {
      list-style: none;
      margin: 0 0 0.25em 0.5em;
      padding: 0 0 0 0.7em;
    }
    .toc-list li {
      font-size: 0.99em;
      color: #14281d;
      background: none;
      border: none;
      margin-bottom: 0.10em;
      letter-spacing: 0.01em;
      text-align: left;
      padding: 0.04em 0;
      font-weight: 400;
    }
    @media (max-width: 1080px) {
      :root { --main-panel-width: 96vw; }
      #welcome, .regulamin-panel, #toc-container { max-width: 99vw; }
    }
    @media (max-width: 700px) {
      h1 { font-size: 1.4rem; }
      :root { --main-panel-width: 99vw; }
      #welcome, .regulamin-panel, #toc-container { padding: 1.2em 0.1em 1.4em 0.1em; min-width: 0; }
      .promo-image { height: 28px;}
    }
  </style>
</head>
<body>
  <div id="lang-select-container">
    <select id="lang-select" aria-label="Wybierz język">
      <option value="pl">PL</option>
      <option value="en">ENG</option>
      <option value="de">GER</option>
    </select>
  </div>
  <h1>CLT HUB</h1>
  <div id="main-area">
    <div class="panel-wrap">
      <div id="welcome">
        <div class="promo-container">
          <img class="promo-image" src="logo.png" alt="Logo"/>
        </div>
        <p class="title">
          <span class="headline">CLT level up!</span>
        </p>
        <div class="desc-container">
          <p class="desc"></p>
        </div>
        <div class="button-row">
          <button id="buyAcceptBtn">
            <span class="btn-main"></span>
            <span class="btn-sub"></span>
            <span class="btn-note"></span>
          </button>
        </div>
      </div>
      <div class="regulamin-panel" id="regulamin"></div>
    </div>
    <div id="toc-container">
      <h2 id="toc-title"></h2>
      <div id="toc-sections"></div>
    </div>
  </div>
  <script>
    // --- REGULAMIN
    const REGULAMIN = {
      pl: `
        <h2>Regulamin korzystania z narzędzi CLTHUB</h2>
        <ol>
          <li>Strona ma wyłącznie charakter informacyjny i edukacyjny. Nie zastępuje konsultacji z uprawnionym konstruktorem ani nie stanowi oferty handlowej.</li>
          <li>Kalkulatory i narzędzia mają charakter poglądowy i nie mogą być podstawą do projektowania ani realizacji inwestycji budowlanych bez indywidualnej weryfikacji przez uprawnionych specjalistów.</li>
          <li>Autor nie ponosi odpowiedzialności za wykorzystanie narzędzi i materiałów zamieszczonych na stronie w procesie projektowania, realizacji lub eksploatacji obiektów budowlanych.</li>
          <li>Użytkownik korzysta z narzędzi dobrowolnie i na własne ryzyko.</li>
          <li>Wszelkie prawa autorskie do treści, kalkulatorów i materiałów zastrzeżone.</li>
          <li>Kontakt z autorem: Piotr Baltyn, cltplhub@gmail.com</li>
        </ol>
        <div style="margin-top:14px; font-size:0.95em; color:#e0e0e0;">
          Wszelkie prawa zastrzeżone © CLTHUB.PL
        </div>
      `,
      en: `
        <h2>Terms of Use for CLTHUB Tools</h2>
        <ol>
          <li>This website is for informational and educational purposes only. It does not replace consultation with a licensed structural engineer and does not constitute a commercial offer.</li>
          <li>All calculators and tools are for reference only and may not be used as the basis for design or implementation of construction projects without individual verification by qualified professionals.</li>
          <li>The author is not responsible for any use of the tools and materials presented on this website in the design, implementation, or operation of construction projects.</li>
          <li>The user uses the tools voluntarily and at their own risk.</li>
          <li>All copyrights to content, calculators, and materials are reserved.</li>
          <li>Contact the author: Piotr Baltyn, cltplhub@gmail.com</li>
        </ol>
        <div style="margin-top:14px; font-size:0.95em; color:#e0e0e0;">
          All rights reserved © CLTHUB.PL
        </div>
      `,
      de: `
        <h2>Nutzungsbedingungen für CLTHUB-Tools</h2>
        <ol>
          <li>Die Seite dient ausschließlich Informations- und Ausbildungszwecken. Sie ersetzt keine Beratung durch einen befugten Statiker und stellt kein kommerzielles Angebot dar.</li>
          <li>Die Rechner und Tools dienen nur als Orientierungshilfe und dürfen nicht ohne individuelle Prüfung durch qualifizierte Fachleute als Grundlage für die Planung oder Durchführung von Bauvorhaben verwendet werden.</li>
          <li>Der Autor übernimmt keine Haftung für die Nutzung der auf der Seite bereitgestellten Tools und Materialien im Rahmen der Planung, Ausführung oder Nutzung von Bauwerken.</li>
          <li>Die Nutzung der Tools erfolgt freiwillig und auf eigenes Risiko.</li>
          <li>Alle Urheberrechte an Inhalten, Rechnern und Materialien sind vorbehalten.</li>
          <li>Kontakt zum Autor: Piotr Baltyn, cltplhub@gmail.com</li>
        </ol>
        <div style="margin-top:14px; font-size:0.95em; color:#e0e0e0;">
          Alle Rechte vorbehalten © CLTHUB.PL
        </div>
      `
    };

    // --- UI/Nagłówki/przyciski
    const UI = {
      pl: {
        headline: "CLT level up!",
        desc: "Odnośnik prowadzi do materiałów o podwyższonym poziomie zaawansowania i opisuje tematykę CLT bardziej szczegółowo i detalicznie niż w typowych broszurach marketingowych. Materiały mają wyłącznie charakter informacyjny i nie zastępują konsultacji z konstruktorem lub innymi uprawnionymi specjalistami.",
        btn: { main: "Wchodzę", sub: "akceptuję warunki Regulaminu", note: "(jedna sesja bezpłatnie)" },
        tocTitle: "Spis treści"
      },
      en: {
        headline: "CLT level up!",
        desc: "The link leads to materials with an advanced level and describes CLT topics in more detail than typical marketing brochures. These materials are for information only and do not replace consultation with a structural engineer or other qualified specialists.",
        btn: { main: "Enter", sub: "I accept the Terms and Conditions", note: "(one free session)" },
        tocTitle: "Table of contents"
      },
      de: {
        headline: "CLT level up!",
        desc: "Der Link führt zu Materialien auf fortgeschrittenem Niveau und beschreibt CLT-Themen ausführlicher und detaillierter als übliche Marketingbroschüren. Diese Materialien dienen nur zur Information und ersetzen nicht die Beratung durch einen Statiker oder andere qualifizierte Fachleute.",
        btn: { main: "Ich trete ein", sub: "Ich akzeptiere die Bedingungen des Regelwerks", note: "(eine Sitzung kostenlos)" },
        tocTitle: "Inhaltsverzeichnis"
      }
    };

    // ---- Pobierz spis treści z toc.json, sekcje + podsekcje
    const TOC_JSON_URL = "https://raw.githubusercontent.com/clthubpl/kalkulator-szablon/main/docs/toc.json";
    let tocData = null;
    let currentLang = localStorage.getItem('clthub_lang') || 'pl';

    async function loadTOC() {
      try {
        const resp = await fetch(TOC_JSON_URL);
        tocData = await resp.json();
      } catch (e) {
        tocData = [];
      }
    }

    function renderTOC(lang) {
      document.getElementById('toc-title').textContent = UI[lang].tocTitle;
      const container = document.getElementById('toc-sections');
      container.innerHTML = "";
      if (!tocData || !tocData[lang]) return;

      tocData[lang].forEach(section => {
        // Każda sekcja
        const secDiv = document.createElement('div');
        secDiv.className = "toc-section";
        // Tytuł sekcji
        if (section.kategoria) {
          const secTitle = document.createElement('div');
          secTitle.className = "toc-section-title";
          secTitle.textContent = section.kategoria;
          secDiv.appendChild(secTitle);
        }
        // Lista kalkulatorów/podsekcji
        if (section.kalkulatory && section.kalkulatory.length > 0) {
          const ul = document.createElement('ul');
          ul.className = "toc-list";
          section.kalkulatory.forEach(calc => {
            const li = document.createElement('li');
            li.textContent = calc.nazwa || calc;
            // Jeśli jest link, zrób aktywny
            if (calc.link) {
              const a = document.createElement('a');
              a.href = calc.link;
              a.textContent = calc.nazwa;
              a.style.color = "#218838";
              a.target = "_blank";
              li.innerHTML = '';
              li.appendChild(a);
            }
            // Jeśli są podsekcje (podlisty)
            if (calc.podsekcje && calc.podsekcje.length > 0) {
              const subUl = document.createElement('ul');
              subUl.className = "toc-list";
              calc.podsekcje.forEach(sub => {
                const subLi = document.createElement('li');
                subLi.textContent = sub.nazwa || sub;
                if (sub.link) {
                  const a = document.createElement('a');
                  a.href = sub.link;
                  a.textContent = sub.nazwa;
                  a.style.color = "#218838";
                  a.target = "_blank";
                  subLi.innerHTML = '';
                  subLi.appendChild(a);
                }
                subUl.appendChild(subLi);
              });
              li.appendChild(subUl);
            }
            ul.appendChild(li);
          });
          secDiv.appendChild(ul);
        }
        container.appendChild(secDiv);
      });
    }

    function renderWelcome(lang) {
      document.querySelector('.headline').textContent = UI[lang].headline;
      document.querySelector('.desc').textContent = UI[lang].desc;
      const btn = document.getElementById('buyAcceptBtn');
      btn.innerHTML = `
        <span class="btn-main">${UI[lang].btn.main}</span>
        <span class="btn-sub">${UI[lang].btn.sub}</span>
        <span class="btn-note">${UI[lang].btn.note}</span>
      `;
      btn.onclick = () => {
        window.location.href = `HUBCLT.html?free=1&lang=${lang}#calc-mass`;
      };
    }
    function renderRegulamin(lang) {
      document.getElementById('regulamin').innerHTML = REGULAMIN[lang];
    }
    document.getElementById('lang-select').addEventListener('change', function () {
      currentLang = this.value;
      localStorage.setItem('clthub_lang', currentLang);
      renderWelcome(currentLang);
      renderRegulamin(currentLang);
      renderTOC(currentLang);
    });
    window.addEventListener('DOMContentLoaded', async () => {
      document.getElementById('lang-select').value = currentLang;
      await loadTOC();
      renderWelcome(currentLang);
      renderRegulamin(currentLang);
      renderTOC(currentLang);
    });
  </script>
</body>
</html>
