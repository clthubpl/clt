<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>CLT HUB PL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #e0e0e0;
      margin: 0;
      padding: 0;
      color: #14281d;
      min-height: 100vh;
    }
    nav {
      width: 100%;
      min-height: 54px;
      background: #1c3426;
      box-shadow: 0 2px 6px rgba(0,0,0,0.10);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1.2rem;
      border-radius: 0 0 9px 9px;
      position: relative;
      z-index: 100;
    }
    .logo-nav {
      height: 38px;
      margin-right: 1.2em;
      margin-left: 0.5em;
      border-radius: 5px;
      background: #fff;
      box-shadow: 0 1px 5px #1c342633;
    }
    .menu {
      display: flex;
      align-items: center;
      gap: 1.7em;
    }
    .dropdown {
      position: relative;
      display: inline-block;
    }
    .dropbtn {
      background: none;
      color: #e0e0e0;
      padding: 0.2em 0.7em;
      font-size: 1.08em;
      border: none;
      cursor: pointer;
      font-weight: 500;
      border-radius: 6px;
      transition: background 0.16s, color 0.16s;
    }
    .dropbtn:hover, .dropdown:focus-within .dropbtn {
      background: #218838;
      color: #fff;
    }
    .dropdown-content {
      display: none;
      position: absolute;
      background: #1c3426;
      min-width: 210px;
      box-shadow: 0 8px 24px 0 rgba(32,56,44,0.21);
      border-radius: 8px;
      z-index: 101;
      margin-top: 5px;
    }
    .dropdown:focus-within .dropdown-content, .dropdown:hover .dropdown-content {
      display: block;
      animation: fadeIn 0.22s;
    }
    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }
    .dropdown-item {
      color: #e5ede0;
      padding: 0.7em 1em;
      text-decoration: none;
      display: block;
      border-bottom: 1px solid #29443022;
      background: none;
      font-size: 1.05em;
      cursor: pointer;
      border-radius: 4px;
      transition: background 0.14s, color 0.14s;
    }
    .dropdown-item:last-child {border-bottom: none;}
    .dropdown-item:hover {
      background: #218838;
      color: #fff;
    }
    .lang-select-container {
      margin-left: auto;
      margin-right: 0.2em;
    }
    #lang-select {
      font-size: 1em;
      padding: 0.22em 1.1em;
      border-radius: 6px;
      border: 1px solid #999;
      background: #fff;
      color: #14281d;
      margin-left: 0.6em;
    }
    .content {
      max-width: 850px;
      margin: 2.2em auto 1.8em auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 3px 22px #1c342611;
      padding: 2.5em 2em 2.6em 2em;
      min-height: 340px;
      position: relative;
    }
    h1 {
      color: #184123;
      text-align: center;
      font-size: 2rem;
      letter-spacing: 0.03em;
      margin-bottom: 0.55em;
    }
    .calc-placeholder, .build-placeholder {
      font-size: 1.11em;
      background: #e8f1e7;
      border-left: 3px solid #218838;
      border-radius: 8px;
      padding: 1.5em 1em 1.3em 1em;
      margin: 1.3em 0;
      color: #184123;
      min-height: 110px;
    }
    #calculator-frame-container {
      margin: 1.2em 0 2em 0;
      display: none;
    }
    #calculator-frame {
      width: 100%;
      min-height: 470px;
      border: none;
      border-radius: 9px;
      box-shadow: 0 2px 12px #14281d22;
      background: #f7faf6;
    }
    .footer {
      background: #14281d;
      color: #fff;
      width: 100%;
      text-align: center;
      padding: 1.12rem 0 1rem 0;
      border-radius: 18px 18px 0 0;
      font-size: 0.98rem;
      position: fixed;
      bottom: 0;
      left: 0;
      letter-spacing: 0.01em;
      z-index: 10;
    }
    .footer a {color:#fff;text-decoration:underline;}
    @media (max-width: 900px) {
      .content {max-width: 99vw; padding: 1.1em 0.1em 2.5em 0.1em;}
      .footer {font-size: 0.96rem;}
      nav {padding: 0 0.2rem;}
    }
  </style>
</head>
<body>
  <nav>
    <img src="logo.png" class="logo-nav" alt="Logo CLT HUB"/>
    <div class="menu">
      <div class="dropdown" tabindex="0">
        <button class="dropbtn" id="kalk-dropdown-btn">Kalkulatory</button>
        <div class="dropdown-content" id="calcs-dropdown">
          <!-- Kalkulatory z JSON będą tu automatycznie -->
        </div>
      </div>
      <div class="dropdown" tabindex="0">
        <button class="dropbtn" id="build-dropdown-btn">Budowa</button>
        <div class="dropdown-content" id="build-dropdown">
          <a class="dropdown-item" href="#build-typy">Typy obiektów CLT</a>
          <a class="dropdown-item" href="#build-co-to-jest-clt">Co to jest CLT?</a>
        </div>
      </div>
    </div>
    <div class="lang-select-container">
      <select id="lang-select" aria-label="Wybierz język">
        <option value="pl">PL</option>
        <option value="en">ENG</option>
        <option value="de">GER</option>
      </select>
    </div>
  </nav>
  <div class="content">
    <h1 id="main-title">CLT HUB PL</h1>
    <div id="main-section">
      <div class="calc-placeholder" id="default-text">
        Wybierz kalkulator z menu powyżej.<br>
        Kalkulatory CLT dostępne są po lewej w menu „Kalkulatory”.<br>
        Możesz korzystać z wszystkich narzędzi – nowe pojawiają się automatycznie po dodaniu do katalogu <strong>docs/</strong>.
      </div>
    </div>
    <div id="calculator-frame-container">
      <iframe id="calculator-frame" src=""></iframe>
    </div>
  </div>
  <footer class="footer">
    ©® Wszelkie prawa zastrzeżone (All rights reserved). Autor: Piotr Baltyn <a href="mailto:cltplhub@gmail.com">cltplhub@gmail.com</a>
  </footer>
  <script>
    // --- Języki ---
    const langStrings = {
      pl: {
        mainTitle: "CLT HUB PL",
        kalkulatory: "Kalkulatory",
        budowa: "Budowa",
        buildDropdown: [
          { href: "#build-typy", text: "Typy obiektów CLT" },
          { href: "#build-co-to-jest-clt", text: "Co to jest CLT?" }
        ],
        wybierz: "Wybierz kalkulator z menu powyżej.<br>Kalkulatory CLT dostępne są po lewej w menu „Kalkulatory”.<br>Możesz korzystać z wszystkich narzędzi – nowe pojawiają się automatycznie po dodaniu do katalogu <strong>docs/</strong>."
      },
      en: {
        mainTitle: "CLT HUB EN",
        kalkulatory: "Calculators",
        budowa: "Construction",
        buildDropdown: [
          { href: "#build-typy", text: "Types of CLT objects" },
          { href: "#build-co-to-jest-clt", text: "What is CLT?" }
        ],
        wybierz: "Select a calculator from the menu above.<br>CLT calculators are available in the “Calculators” menu on the left.<br>All tools are available – new ones appear automatically after being added to the <strong>docs/</strong> directory."
      },
      de: {
        mainTitle: "CLT HUB DE",
        kalkulatory: "Rechner",
        budowa: "Bau",
        buildDropdown: [
          { href: "#build-typy", text: "CLT-Gebäudetypen" },
          { href: "#build-co-to-jest-clt", text: "Was ist CLT?" }
        ],
        wybierz: "Wählen Sie einen Rechner aus dem obigen Menü.<br>CLT-Rechner sind im Menü „Rechner“ auf der linken Seite verfügbar.<br>Alle Tools sind verfügbar – neue erscheinen automatisch nach dem Hinzufügen zum <strong>docs/</strong>-Verzeichnis."
      }
    };
    let kalkulatoryList = [];
    let currentLang = 'pl';

    // --- Ładowanie kalkulatorów z JSON ---
    function loadCalculatorsList() {
      fetch('docs/kalkulatory.json')
        .then(r=>r.json())
        .then(list=>{
          kalkulatoryList = list;
          updateCalculatorsDropdown();
        });
    }

    // --- Generowanie dropdowna kalkulatorów ---
    function updateCalculatorsDropdown() {
      const dropdown = document.getElementById('calcs-dropdown');
      dropdown.innerHTML = "";
      kalkulatoryList.forEach(k=>{
        const a = document.createElement('a');
        a.className = "dropdown-item";
        a.href = "#calc-" + k.id;
        a.textContent = k['title_'+currentLang] || k.title_pl;
        a.onclick = (e)=>{
          e.preventDefault();
          showCalculatorFrame(k.file, a.textContent);
        };
        dropdown.appendChild(a);
      });
    }

    // --- Dynamiczne ładowanie kalkulatora (iframe) ---
    function showCalculatorFrame(url, label) {
      document.getElementById('main-section').style.display = "none";
      document.getElementById('calculator-frame-container').style.display = 'block';
      document.getElementById('calculator-frame').src = url;
      document.title = label + " | CLT HUB";
      setTimeout(()=>document.getElementById('calculator-frame-container').scrollIntoView({behavior:"smooth"}), 120);
    }

    // --- Zmiana języka ---
    document.getElementById('lang-select').addEventListener('change', function() {
      currentLang = this.value;
      applyLang(currentLang);
      updateCalculatorsDropdown();
      localStorage.setItem('clthub_lang', currentLang);
    });

    function applyLang(lang) {
      document.getElementById('main-title').textContent = langStrings[lang].mainTitle;
      document.getElementById('kalk-dropdown-btn').textContent = langStrings[lang].kalkulatory;
      document.getElementById('build-dropdown-btn').textContent = langStrings[lang].budowa;
      // Budowa dropdown
      const buildDrop = document.getElementById('build-dropdown');
      buildDrop.innerHTML = "";
      langStrings[lang].buildDropdown.forEach(item=>{
        const a = document.createElement('a');
        a.className = "dropdown-item";
        a.href = item.href;
        a.textContent = item.text;
        buildDrop.appendChild(a);
      });
      // Default tekst
      document.getElementById('default-text').innerHTML = langStrings[lang].wybierz;
    }

    // --- Start ---
    window.addEventListener('DOMContentLoaded', () => {
      currentLang = localStorage.getItem('clthub_lang') || 'pl';
      document.getElementById('lang-select').value = currentLang;
      applyLang(currentLang);
      loadCalculatorsList();
      updateCalculatorsDropdown();
    });
  </script>
</body>
</html>
